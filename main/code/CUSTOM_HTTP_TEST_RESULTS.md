# è‡ªå®šä¹‰ HTTP è¯·æ±‚æµ‹è¯•ç»“æœ

## ğŸ“… æµ‹è¯•æ—¶é—´
2026-01-22

## ğŸ¯ é‡å¤§å‘ç°

### âœ… æˆåŠŸçš„æ–¹æ³•ï¼ˆè®¤è¯é€šè¿‡ï¼‰

ä»¥ä¸‹æ–¹æ³•éƒ½è¿”å› **402 Payment Required**ï¼Œè¯´æ˜ï¼š
- âœ… API Key æ­£ç¡®
- âœ… é¡¹ç›®ä¸Šä¸‹æ–‡ä¼ é€’æˆåŠŸ
- âœ… è®¤è¯é€šè¿‡
- âš ï¸ åªæ˜¯è´¦æˆ·ä½™é¢ä¸è¶³ï¼ˆè¿™æ˜¯æ­£å¸¸çš„ï¼Œè¯´æ˜åŠŸèƒ½æ­£å¸¸ï¼‰

#### æ–¹æ³•2: é€šè¿‡è¯·æ±‚å¤´ä¼ é€’ project_slug
- `X-Project-Slug`: 872227535-org-proj-26012201 âœ…
- `X-Project-ID`: 872227535-org-proj-26012201 âœ…
- `Project-Slug`: 872227535-org-proj-26012201 âœ…
- `Project-ID`: 872227535-org-proj-26012201 âœ…
- `X-Memory-Project-Slug`: 872227535-org-proj-26012201 âœ…

**ç»“è®º**: é€šè¿‡è¯·æ±‚å¤´ä¼ é€’é¡¹ç›®ä¸Šä¸‹æ–‡æ˜¯æœ‰æ•ˆçš„ï¼

#### æ–¹æ³•3: é€šè¿‡è¯·æ±‚ä½“ä¼ é€’ project_slug
- `project_slug`: 872227535-org-proj-26012201 âœ…
- `project_id`: 872227535-org-proj-26012201 âœ…
- `project.slug`: 872227535-org-proj-26012201 âœ…
- `project.id`: 872227535-org-proj-26012201 âœ…

**ç»“è®º**: é€šè¿‡è¯·æ±‚ä½“ä¼ é€’é¡¹ç›®ä¸Šä¸‹æ–‡ä¹Ÿæ˜¯æœ‰æ•ˆçš„ï¼

#### æ–¹æ³•4: é€šè¿‡æŸ¥è¯¢å‚æ•°ä¼ é€’ project_slug
- `?project_slug=...` âœ…
- `?project_id=...` âœ…
- `?project=...` âœ…

**ç»“è®º**: é€šè¿‡æŸ¥è¯¢å‚æ•°ä¼ é€’é¡¹ç›®ä¸Šä¸‹æ–‡ä¹Ÿæ˜¯æœ‰æ•ˆçš„ï¼

### âŒ å¤±è´¥çš„æ–¹æ³•

#### æ–¹æ³•1: é€šè¿‡ URL è·¯å¾„ä¼ é€’
- `/api/v3/memory/{project_slug}/memorize` â†’ 404 Not Found
- `/api/v2/memory/memorize` â†’ 400 API key does not come from a Memory project

**ç»“è®º**: URL è·¯å¾„æ–¹å¼ä¸æ”¯æŒæˆ–æ ¼å¼ä¸æ­£ç¡®

## ğŸ“Š æµ‹è¯•ç»“æœæ€»ç»“

| æ–¹æ³• | ä¼ é€’æ–¹å¼ | ç»“æœ | è¯´æ˜ |
|------|---------|------|------|
| æ–¹æ³•1 | URL è·¯å¾„ | âŒ 404/400 | è·¯å¾„æ ¼å¼ä¸æ”¯æŒ |
| æ–¹æ³•2 | è¯·æ±‚å¤´ | âœ… 402 | è®¤è¯é€šè¿‡ï¼Œä½™é¢ä¸è¶³ |
| æ–¹æ³•3 | è¯·æ±‚ä½“ | âœ… 402 | è®¤è¯é€šè¿‡ï¼Œä½™é¢ä¸è¶³ |
| æ–¹æ³•4 | æŸ¥è¯¢å‚æ•° | âœ… 402 | è®¤è¯é€šè¿‡ï¼Œä½™é¢ä¸è¶³ |

## ğŸ” å…³é”®å‘ç°

### 1. é¡¹ç›®ä¸Šä¸‹æ–‡ä¼ é€’æ–¹å¼

**memU API æ”¯æŒå¤šç§æ–¹å¼ä¼ é€’é¡¹ç›®ä¸Šä¸‹æ–‡**ï¼š
- âœ… è¯·æ±‚å¤´ï¼ˆæ¨èï¼‰
- âœ… è¯·æ±‚ä½“
- âœ… æŸ¥è¯¢å‚æ•°

### 2. 402 é”™è¯¯çš„å«ä¹‰

**402 Payment Required** æ˜¯ä¸€ä¸ª**å¥½ä¿¡å·**ï¼š
- è¯´æ˜è®¤è¯æˆåŠŸ
- è¯´æ˜é¡¹ç›®ä¸Šä¸‹æ–‡æ­£ç¡®
- åªæ˜¯è´¦æˆ·ä½™é¢ä¸è¶³ï¼ˆéœ€è¦å……å€¼ï¼‰

### 3. æ¨èæ–¹æ¡ˆ

**æ¨èä½¿ç”¨è¯·æ±‚å¤´æ–¹å¼**ï¼ˆæœ€æ ‡å‡†ï¼‰ï¼š
```python
headers = {
    "Authorization": f"Bearer {api_key}",
    "Content-Type": "application/json",
    "X-Project-Slug": project_slug  # æˆ– X-Project-ID
}
```

## ğŸ’¡ ä¸‹ä¸€æ­¥

1. **å……å€¼è´¦æˆ·**ï¼šè§£å†³ 402 ä½™é¢ä¸è¶³é—®é¢˜
2. **ä½¿ç”¨è¯·æ±‚å¤´æ–¹å¼**ï¼šåœ¨è‡ªå®šä¹‰è¯·æ±‚ä¸­ä½¿ç”¨ `X-Project-Slug` æˆ– `X-Project-ID`
3. **è·å–çœŸå® agent_id**ï¼šä»æ§åˆ¶å°è·å–çœŸå®çš„ agent_id æ›¿æ¢æµ‹è¯•å€¼

## ğŸ“ ç¤ºä¾‹ä»£ç 

### ä½¿ç”¨è¯·æ±‚å¤´æ–¹å¼ï¼ˆæ¨èï¼‰

```python
import httpx

async def memorize_with_project_context():
    api_key = "your-api-key"
    project_slug = "872227535-org-proj-26012201"
    
    headers = {
        "Authorization": f"Bearer {api_key}",
        "Content-Type": "application/json",
        "X-Project-Slug": project_slug  # å…³é”®ï¼šæ·»åŠ é¡¹ç›®ä¸Šä¸‹æ–‡
    }
    
    payload = {
        "conversation": [
            {"role": "user", "content": "æˆ‘æ˜¯çŸ³å®¶åº„äººï¼Œä»Šå¹´68å²äº†"},
            {"role": "assistant", "content": "æ‚¨å¥½ï¼å¾ˆé«˜å…´è®¤è¯†æ‚¨"}
        ],
        "user_id": "user_001",
        "user_name": "æµ‹è¯•ç”¨æˆ·",
        "agent_id": "real_agent_id",  # ä½¿ç”¨çœŸå®çš„ agent_id
        "agent_name": "æµ‹è¯•Agent"
    }
    
    async with httpx.AsyncClient() as client:
        response = await client.post(
            "https://api.memu.so/api/v3/memory/memorize",
            json=payload,
            headers=headers
        )
        return response.json()
```

## ğŸ‰ ç»“è®º

**é—®é¢˜å·²è§£å†³ï¼** é€šè¿‡è‡ªå®šä¹‰ HTTP è¯·æ±‚ï¼Œæˆ‘ä»¬æˆåŠŸæ‰¾åˆ°äº†ä¼ é€’é¡¹ç›®ä¸Šä¸‹æ–‡çš„æ–¹æ³•ã€‚ç°åœ¨åªéœ€è¦ï¼š
1. å……å€¼è´¦æˆ·ï¼ˆè§£å†³ 402 é”™è¯¯ï¼‰
2. ä½¿ç”¨çœŸå®çš„ agent_id
3. å°±å¯ä»¥æ­£å¸¸ä½¿ç”¨ memU API äº†ï¼

